<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Order Confirmation - BookVerse</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">

    <!-- common css import -->
    <div th:replace="common/user/css :: css"></div>
</head>
<body class="checkout">
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- header-area-start -->
<div th:replace="common/user/header :: header"></div>
<!-- header-area-end -->

<!-- breadcrumbs-area-start -->
<div class="breadcrumbs-area mb-70">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumbs-menu">
                    <ul>
                        <li><a th:href="@{/}">Home</a></li>
                        <li><a th:href="@{/my-orders}">My Orders</a></li>
                        <li><a href="#" class="active">Order Confirmation</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- breadcrumbs-area-end -->

<!-- entry-header-area-start -->
<div class="entry-header-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="entry-header-title">
                    <h2>Order Confirmation</h2>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- entry-header-area-end -->

<!-- checkout-area-start -->
<div class="checkout-area mb-70">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <!-- Error/Success messages -->
                <div th:if="${error}" class="alert alert-danger" style="padding: 15px; margin-bottom: 20px; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; border-radius: 4px;" th:text="${error}"></div>
                <div th:if="${success}" class="alert alert-success" style="padding: 15px; margin-bottom: 20px; background: #d4edda; color: #155724; border: 1px solid #c3e6cb; border-radius: 4px;" th:text="${success}"></div>
            </div>
        </div>
        
        <div class="row" th:if="${order != null}">
            <div class="col-lg-8 offset-lg-2">
                <div class="order-confirmation-box" style="background: #fff; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <!-- Order Info -->
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2 style="color: #28a745; margin-bottom: 10px;">
                            <iconify-icon icon="solar:check-circle-bold" style="font-size: 48px; color: #28a745;"></iconify-icon>
                        </h2>
                        <h3 style="color: #333; margin-bottom: 10px;">Order Placed Successfully!</h3>
                        <p style="color: #666; font-size: 16px;">Order ID: <strong th:text="${order.orderId}">#123</strong></p>
                        <p style="color: #666; font-size: 16px;">Status: 
                            <span class="badge" 
                                  th:classappend="${order.status == 'pending' ? 'badge-warning' : (order.status == 'processing' ? 'badge-info' : 'badge-success')}"
                                  th:text="${order.status}">Pending</span>
                        </p>
                    </div>

                    <!-- QR Code Section -->
                    <div style="text-align: center; margin: 40px 0; padding: 30px; background: #f9f9f9; border-radius: 8px;">
                        <h4 style="margin-bottom: 20px; color: #333;">Order QR Code</h4>
                        <div style="display: inline-block; padding: 20px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <img th:if="${qrCode != null}" 
                                 th:src="${qrCode}" 
                                 alt="QR Code" 
                                 style="max-width: 300px; height: auto; display: block;">
                        </div>
                        <p style="margin-top: 20px; color: #666; font-size: 14px;">
                            Scan this QR code to view order details
                        </p>
                    </div>

                    <!-- Order Details -->
                    <div style="margin: 30px 0;">
                        <h4 style="margin-bottom: 20px; color: #333; border-bottom: 2px solid #eee; padding-bottom: 10px;">Order Details</h4>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr style="border-bottom: 1px solid #eee;">
                                <td style="padding: 10px; color: #666; font-weight: 600;">Total Amount:</td>
                                <td style="padding: 10px; text-align: right; color: #333; font-size: 18px; font-weight: 700;">
                                    <span th:text="|$${#numbers.formatDecimal(order.totalAmount, 1, 2)}|">$0.00</span>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #eee;">
                                <td style="padding: 10px; color: #666; font-weight: 600;">Delivery Address:</td>
                                <td style="padding: 10px; text-align: right; color: #333;">
                                    <span th:text="${order.address}">Address</span>
                                </td>
                            </tr>
                            <tr th:if="${order.note != null && !order.note.isEmpty()}" style="border-bottom: 1px solid #eee;">
                                <td style="padding: 10px; color: #666; font-weight: 600;">Note:</td>
                                <td style="padding: 10px; text-align: right; color: #333;">
                                    <span th:text="${order.note}">Note</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; color: #666; font-weight: 600;">Created At:</td>
                                <td style="padding: 10px; text-align: right; color: #333;">
                                    <span th:text="${order.createdAt != null ? #temporals.format(order.createdAt, 'yyyy-MM-dd HH:mm') : 'N/A'}">2024-01-01 12:00</span>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Send Payment Request Section -->
                    <div th:if="${order.status == 'pending'}" style="margin: 30px 0; padding: 30px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                        <h4 style="margin-bottom: 15px; color: #856404;">
                            <iconify-icon icon="solar:bell-bold"></iconify-icon>
                            Send Payment Request to Admin
                        </h4>
                        <p style="color: #856404; margin-bottom: 20px;">
                            Click the button below to notify the admin that you have completed payment and request them to process your order.
                        </p>
                        <form th:action="@{/checkout/send-payment-request/{id}(id=${order.orderId})}" method="post" style="margin-top: 20px;">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                            <div style="margin-bottom: 15px;">
                                <label for="message" style="display: block; margin-bottom: 8px; color: #333; font-weight: 600;">Additional Message (Optional):</label>
                                <textarea name="message" 
                                          id="message" 
                                          rows="3" 
                                          placeholder="Add any additional information about your payment..."
                                          style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; resize: vertical;"></textarea>
                            </div>
                            <button type="submit" 
                                    style="background: #ffc107; color: #333; border: none; padding: 12px 30px; font-size: 16px; font-weight: 700; text-transform: uppercase; cursor: pointer; border-radius: 4px; width: 100%;">
                                <iconify-icon icon="solar:send-bold"></iconify-icon>
                                Send Payment Request to Admin
                            </button>
                        </form>
                    </div>

                    <!-- Action Buttons -->
                    <div style="margin-top: 30px; text-align: center;">
                        <a th:href="@{/my-orders/{id}(id=${order.orderId})}" 
                           class="btn" 
                           style="background: #333; color: #fff; padding: 12px 30px; text-decoration: none; border-radius: 4px; margin-right: 10px; display: inline-block;">
                            View Order Details
                        </a>
                        <a th:href="@{/my-orders}" 
                           class="btn" 
                           style="background: #6c757d; color: #fff; padding: 12px 30px; text-decoration: none; border-radius: 4px; display: inline-block;">
                            View All Orders
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- checkout-area-end -->

<!-- footer-area-start -->
<div th:replace="common/user/footer :: footer"></div>
<!-- footer-area-end -->

<!-- common js import -->
<div th:replace="common/user/js :: js"></div>

<script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>

</body>
</html>

