<!doctype html>
<html class="no-js" lang="en">


<!-- Mirrored from htmldemo.net/koparion/koparion/shop.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Nov 2025 15:14:52 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Bookverse - Books List</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">

    <!-- common css import -->
    <div th:replace="common/user/css :: css"></div>
    <style>
        /* Fix product cards alignment - only for grid view (#th) */
        /* Make the row containing products use flexbox for grid view only */
        #th .row {
            display: flex !important;
            flex-wrap: wrap;
            align-items: stretch;
        }
        
        /* Make columns stretch to same height in grid view */
        #th .col-xl-3,
        #th .col-lg-4,
        #th .col-md-6,
        #th .col-sm-6 {
            display: flex !important;
            flex-direction: column;
        }
        
        /* Product wrapper in grid view - take full height and use flexbox internally */
        #th .product-wrapper {
            display: flex !important;
            flex-direction: column;
            height: 100%;
            width: 100%;
            position: relative;
            padding-bottom: 50px; /* Space for product-link when visible */
        }
        
        /* Product image container - fixed aspect ratio for consistent height */
        #th .product-wrapper .product-img {
            position: relative;
            width: 100%;
            padding-bottom: 133.33% !important; /* 3:4 aspect ratio (portrait) */
            overflow: hidden;
            background: #f5f5f5;
            flex-shrink: 0;
            height: auto !important;
        }
        
        /* Product image - fill the container */
        #th .product-wrapper .product-img a {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
        }
        
        #th .product-wrapper .product-img img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            display: block;
        }
        
        /* Product details - flexible section */
        #th .product-wrapper .product-details {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 140px;
            padding: 15px 10px 10px;
        }
        
        /* Product rating - consistent height */
        #th .product-wrapper .product-rating {
            min-height: 20px;
            margin-bottom: 8px;
            flex-shrink: 0;
        }
        
        /* Product title - limit to 2 lines with ellipsis */
        #th .product-wrapper .product-details h4 {
            flex: 0 0 auto;
            min-height: 44px;
            max-height: 44px;
            margin-bottom: 10px;
            margin-top: 0;
            overflow: hidden;
        }
        
        #th .product-wrapper .product-details h4 a {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.4;
            max-height: 2.8em;
        }
        
        /* Product price - consistent height */
        #th .product-wrapper .product-price {
            min-height: 30px;
            flex-shrink: 0;
            margin-top: auto;
        }
        
        /* Product flag - maintain positioning */
        #th .product-wrapper .product-flag {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 10;
        }
        
        /* Responsive adjustments for grid view */
        @media (max-width: 991px) {
            #th .product-wrapper .product-img {
                padding-bottom: 133.33% !important; /* Keep 3:4 ratio on tablets */
            }
        }
        
        @media (max-width: 767px) {
            #th .product-wrapper .product-img {
                padding-bottom: 133.33% !important; /* Keep 3:4 ratio on mobile */
            }
            #th .product-wrapper .product-details {
                min-height: 120px;
            }
        }
    </style>
</head>

<body class="shop">
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- Add your site or application content here -->
<!-- header-area-start -->
<div th:replace="common/user/header :: header"></div>
<!-- header-area-end -->
<!-- breadcrumbs-area-start -->
<div class="breadcrumbs-area mb-70">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumbs-menu">
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/shop" class="active">Shop</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- breadcrumbs-area-end -->
<!-- shop-main-area-start -->
<div class="shop-main-area mb-70">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-12 col-12 order-lg-1 order-2 mt-sm-50 mt-xs-40">
                <div class="shop-left">
                    <div class="section-title-5 mb-30">
                        <h2>Shopping Options</h2>
                    </div>
                    <div class="left-title mb-20">
                        <h4>Category</h4>
                    </div>
                    <div class="left-menu mb-30">
                        <ul style="text-align: left;">
                            <li th:if="${selectedCategory == null}"><a th:href="@{/shop}" class="active"
                                                                       style="text-align:left; display:flex; align-items:center; justify-content:flex-start; gap:8px;">All
                                Categories</a>
                            </li>
                            <li th:unless="${selectedCategory == null}"><a th:href="@{/shop}"
                                                                           style="text-align:left; display:flex; align-items:center; justify-content:flex-start; gap:8px;">All
                                Categories</a></li>
                            <li th:each="category : ${categories}">
                                <a th:href="@{/shop(categoryId=${category.categoryId})}"
                                   th:classappend="${selectedCategory == category.categoryId ? 'active' : ''}"
                                   style="text-align:left; display:flex; align-items:center; justify-content:flex-start; gap:8px;">
                                    <span th:text="${category.name}" style="float:none;"></span>
                                    <span th:text="'(' + ${category.books != null ? category.books.size() : 0} + ')'"
                                          style="float:none;">(0)</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="left-title mb-20">
                        <h4>Price</h4>
                    </div>
                    <div class="left-menu mb-30">
                        <ul>
                            <li><a th:href="@{/shop(minPrice=0, maxPrice=10)}">$0.00-$9.99</a></li>
                            <li><a th:href="@{/shop(minPrice=10, maxPrice=30)}">$10.00-$29.99</a></li>
                            <li><a th:href="@{/shop(minPrice=30, maxPrice=50)}">$30.00-$49.99</a></li>
                            <li><a th:href="@{/shop(minPrice=50, maxPrice=100)}">$50.00-$99.99</a></li>
                            <li><a th:href="@{/shop(minPrice=100, maxPrice=1000)}">$100.00 and above</a></li>
                        </ul>
                    </div>
                    <div class="left-title mb-20">
                        <h4>Sale</h4>
                    </div>
                    <div class="left-menu mb-30">
                        <ul>
                            <li>
                                <a th:href="@{/shop(view=${viewType}, saleOnly=true, page=0, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir})}"
                                   th:classappend="${saleOnly} ? 'active' : ''">Only on sale</a>
                            </li>
                        </ul>
                    </div>
                    <div class="left-title mb-20">
                        <h4>Related</h4>
                    </div>
                    <div class="random-area mb-30">
                        <div class="product-active-2 owl-carousel">
                            <div class="product-total-2">
                                <div class="single-most-product bd mb-18" th:each="book, iterStat : ${randomBooks}"
                                     th:if="${iterStat.index < 3}">
                                    <div class="most-product-img">
                                        <a th:href="@{/shop/product/{id}(id=${book.bookId})}">
                                            <img th:src="${book.imageUrl != null ? book.imageUrl : '/user/img/product/1.jpg'}"
                                                 th:alt="${book.title}" alt="book"/>
                                        </a>
                                    </div>
                                    <div class="most-product-content">
                                        <div class="product-rating">
                                            <ul>
                                                <li th:each="i : ${#numbers.sequence(1, 5)}">
                                                    <a href="#">
                                                        <i th:classappend="${i <= 4 ? 'fa fa-star' : 'fa fa-star-o'}"></i>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <h4><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                               th:text="${book.title}">Book
                                            Title</a></h4>
                                        <div class="product-price">
                                            <ul>
                                                <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                    class="old-price"
                                                    style="text-decoration: line-through; color: #888;"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                    $0.00
                                                </li>
                                                <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.discountPrice, 1, 2)}"
                                                    style="color:#d4af37;font-weight:bold;">
                                                    $0.00
                                                </li>
                                                <li th:if="${book.discountPercent == null || book.discountPercent == 0}"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                    $0.00
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="product-total-2" th:if="${randomBooks != null && randomBooks.size() > 3}">
                                <div class="single-most-product bd mb-18" th:each="book, iterStat : ${randomBooks}"
                                     th:if="${iterStat.index >= 3 && iterStat.index < 6}">
                                    <div class="most-product-img">
                                        <a th:href="@{/shop/product/{id}(id=${book.bookId})}">
                                            <img th:src="${book.imageUrl != null ? book.imageUrl : '/user/img/product/1.jpg'}"
                                                 th:alt="${book.title}" alt="book"/>
                                        </a>
                                    </div>
                                    <div class="most-product-content">
                                        <div class="product-rating">
                                            <ul>
                                                <li th:each="i : ${#numbers.sequence(1, 5)}">
                                                    <a href="#">
                                                        <i th:classappend="${i <= 4 ? 'fa fa-star' : 'fa fa-star-o'}"></i>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <h4><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                               th:text="${book.title}">Book
                                            Title</a></h4>
                                        <div class="product-price">
                                            <ul>
                                                <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                    class="old-price"
                                                    style="text-decoration: line-through; color: #888;"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                    $0.00
                                                </li>
                                                <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.discountPrice, 1, 2)}"
                                                    style="color:#d4af37;font-weight:bold;">
                                                    $0.00
                                                </li>
                                                <li th:if="${book.discountPercent == null || book.discountPercent == 0}"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                    $0.00
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="left-title-2 mb-30">
                        <h2>My Wish List</h2>
                        <div class="random-area mb-30" th:if="${wishlistBooksGroups != null && !wishlistBooksGroups.isEmpty()}">
                            <div class="product-active-2 owl-carousel">
                                <!-- Mỗi nhóm 3 items là một slide -->
                                <div th:each="bookGroup, groupIter : ${wishlistBooksGroups}" class="product-total-2">
                                    <div th:each="book, bookIter : ${bookGroup}"
                                         th:class="${bookIter.last} ? 'single-most-product' : 'single-most-product bd mb-18'">
                                        <div class="most-product-img">
                                            <a th:href="@{/shop/product/{id}(id=${book.bookId})}">
                                                <img th:src="${book.imageUrl != null ? book.imageUrl : '/user/img/product/1.jpg'}"
                                                     th:alt="${book.title}" alt="book"/>
                                            </a>
                                        </div>
                                        <div class="most-product-content">
                                            <div class="product-rating">
                                                <ul>
                                                    <li th:each="i : ${#numbers.sequence(1, 5)}">
                                                        <a href="#">
                                                            <i th:classappend="${i <= 4 ? 'fa fa-star' : 'fa fa-star-o'}"></i>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <h4><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                                   th:text="${book.title}">Book Title</a></h4>
                                            <div class="product-price">
                                                <ul>
                                                    <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                        class="old-price"
                                                        style="text-decoration: line-through; color: #888;"
                                                        th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                        $0.00
                                                    </li>
                                                    <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                        th:text="'$' + ${#numbers.formatDecimal(book.discountPrice, 1, 2)}"
                                                        style="color:#d4af37;font-weight:bold;">
                                                        $0.00
                                                    </li>
                                                    <li th:if="${book.discountPercent == null || book.discountPercent == 0}"
                                                        th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                        $0.00
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p th:if="${wishlistBooksGroups == null || wishlistBooksGroups.isEmpty()}">You have no items in your wish list.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-9 col-md-12 col-12 order-lg-2 order-1">
                <div class="category-image mb-30">
                    <a href="#"><img th:src="@{/user/img/banner/32.jpg}" alt="banner"/></a>
                </div>
                <div class="section-title-5 mb-30">
                    <div class="d-flex align-items-center justify-content-between flex-wrap">
                        <h2 class="mb-0">
                            Books
                            <span th:if="${selectedCategoryObj != null}" style="color: #888; font-weight: normal;">
                                | <span th:text="${selectedCategoryObj.name}">Category</span>
                            </span>
                        </h2>
                        <form th:action="@{/shop}" method="get" class="d-flex align-items-center mt-3 mt-lg-0"
                              style="gap:8px;">
                            <input type="hidden" name="view" th:value="${viewType}"/>
                            <input type="hidden" name="categoryId" th:value="${selectedCategory}"/>
                            <input type="hidden" name="sortBy" th:value="${sortBy}"/>
                            <input type="hidden" name="sortDir" th:value="${sortDir}"/>
                            <input type="text" name="search" th:value="${searchKeyword}" placeholder="Search books..."
                                   style="padding:8px 12px;border:1px solid #ddd;border-radius:4px;min-width:260px;"/>
                            <button type="submit"
                                    style="padding:8px 14px;border:none;background:#333;color:#fff;border-radius:4px;">
                                <i class="fa fa-search"></i>
                            </button>
                        </form>
                    </div>
                </div>
                <div class="toolbar mb-30">
                    <div class="shop-tab">
                        <div class="tab-3">
                            <ul class="nav">
                                <li>
                                    <a th:href="@{/shop(view='grid', page=${currentPage}, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir})}"
                                       th:classappend="${viewType} == 'grid' ? 'active' : ''">
                                        <i class="fa fa-th-large"></i>Grid
                                    </a>
                                </li>
                                <li>
                                    <a th:href="@{/shop(view='list', page=${currentPage}, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir})}"
                                       th:classappend="${viewType} == 'list' ? 'active' : ''">
                                        <i class="fa fa-bars"></i>List
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="list-page">
                            <p th:text="'Items ' + ${currentPage * books.size + 1} + '-' + ${currentPage * books.size + books.numberOfElements} + ' of ' + ${totalItems}">
                                Items 1-9 of 11
                            </p>
                        </div>
                    </div>
                    <div class="field-limiter">
                        <div class="control">
                            <span>Show</span>
                            <form th:action="@{/shop}" method="get" style="display:inline;">
                                <input type="hidden" name="view" th:value="${viewType}"/>
                                <input type="hidden" name="page" value="0"/>
                                <input type="hidden" name="categoryId" th:if="${selectedCategory != null}"
                                       th:value="${selectedCategory}"/>
                                <input type="hidden" name="search" th:if="${searchKeyword != null}"
                                       th:value="${searchKeyword}"/>
                                <input type="hidden" name="sortBy" th:value="${sortBy}"/>
                                <input type="hidden" name="sortDir" th:value="${sortDir}"/>
                                <input type="hidden" name="saleOnly" th:if="${saleOnly}" value="true"/>
                                <select name="size" style="width:60px;" onchange="this.form.submit()">
                                    <option th:value="4" th:selected="${books != null && books.size == 4}">4</option>
                                    <option th:value="8" th:selected="${books != null && books.size == 8}">8</option>
                                    <option th:value="12" th:selected="${books != null && books.size == 12}">12</option>
                                    <option th:value="16" th:selected="${books != null && books.size == 16}">16</option>
                                    <option th:value="20" th:selected="${books != null && books.size == 20}">20</option>
                                </select>
                            </form>
                        </div>
                    </div>
                    <div class="toolbar-sorter">
                        <span>Sort By</span>
                        <form th:action="@{/shop}" method="get" style="display:inline;">
                            <input type="hidden" name="view" th:value="${viewType}"/>
                            <input type="hidden" name="page" th:value="${currentPage}"/>
                            <input type="hidden" name="size" th:value="${books.size}"/>
                            <input type="hidden" name="categoryId" th:if="${selectedCategory != null}"
                                   th:value="${selectedCategory}"/>
                            <input type="hidden" name="search" th:if="${searchKeyword != null}"
                                   th:value="${searchKeyword}"/>
                            <input type="hidden" name="sortDir" th:value="${sortDir}"/>
                            <input type="hidden" name="saleOnly" th:if="${saleOnly}" value="true"/>
                            <select id="sorter" name="sortBy" class="sorter-options" data-role="sorter"
                                    onchange="this.form.submit()">
                                <option th:value="'title'" th:selected="${sortBy == 'title'}">Product Name</option>
                                <option th:value="'price'" th:selected="${sortBy == 'price'}">Price</option>
                                <option th:value="'createdAt'" th:selected="${sortBy == 'createdAt'}">Newest</option>
                            </select>
                        </form>
                        <a th:href="@{/shop(view=${viewType}, saleOnly=${saleOnly}, page=${currentPage}, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir == 'asc' ? 'desc' : 'asc'})}">
                            <i th:classappend="${sortDir == 'asc' ? 'fa fa-arrow-up' : 'fa fa-arrow-down'}"></i>
                        </a>
                    </div>
                </div>
                <!-- tab-area-start -->
                <div class="tab-content">
                    <div class="tab-pane fade" th:classappend="${viewType} == 'grid' ? 'show active' : ''" id="th">
                        <div class="row" th:if="${books.isEmpty()}">
                            <div class="col-12">
                                <p class="text-center">No books found.</p>
                            </div>
                        </div>
                        <div class="row" th:unless="${books.isEmpty()}">
                            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6" th:each="book : ${books.content}">
                                <!-- single-product-start -->
                                <div class="product-wrapper mb-40">
                                    <div class="product-img">
                                        <a th:href="@{/shop/product/{id}(id=${book.bookId})}">
                                            <img th:src="${book.imageUrl != null ? book.imageUrl : '/user/img/product/1.jpg'}"
                                                 th:alt="${book.title}"
                                                 class="primary"/>
                                        </a>

                                        <div class="product-flag" th:if="${book.stock == 0}">
                                            <ul>
                                                <li><span class="sale">Out of stock</span></li>
                                            </ul>
                                        </div>
                                        <div class="product-flag"
                                             th:if="${book.discountPercent != null && book.discountPercent > 0}">
                                            <ul>
                                                <li><span class="discount-percentage">-<span
                                                        th:text="${#numbers.formatDecimal(book.discountPercent, 1, 0)}"></span>%</span>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="product-flag" th:if="${book.stock > 0 && book.stock < 10}">
                                            <ul>
                                                <li><span class="sale">Low stock</span></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="product-details text-center">
                                        <div class="product-rating">
                                            <ul>
                                                <li th:each="i : ${#numbers.sequence(1, 5)}">
                                                    <a href="#">
                                                        <i th:classappend="${i <= 4 ? 'fa fa-star' : 'fa fa-star-o'}"></i>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <h4><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                               th:text="${book.title}">Book
                                            Title</a></h4>
                                        <div class="product-price">
                                            <ul>
                                                <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                    class="old-price"
                                                    style="text-decoration: line-through; color: #888;"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                    $0.00
                                                </li>
                                                <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.discountPrice, 1, 2)}"
                                                    style="color:#d4af37;font-weight:bold;">
                                                    $0.00
                                                </li>
                                                <li th:if="${book.discountPercent == null || book.discountPercent == 0}"
                                                    th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                    $0.00
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="product-link">
                                        <div class="product-button">
                                            <a href="#" 
                                               th:if="${book.stock > 0}"
                                               th:onclick="'addToCart(' + ${book.bookId} + ', 1); return false;'"
                                               title="Add to cart">
                                                <i class="fa fa-shopping-cart"></i>Add to cart
                                            </a>
                                            <a href="#" 
                                               th:if="${book.stock == 0}"
                                               class="disabled"
                                               style="pointer-events: none; opacity: 0.5; cursor: not-allowed;"
                                               title="Out of stock">
                                                <i class="fa fa-shopping-cart"></i>Add to cart
                                            </a>
                                        </div>
                                        <div class="add-to-link">
                                            <ul>
                                                <li><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                                       title="Details">
                                                    <i class="fa fa-external-link"></i></a></li>
                                                <li><a href="#" 
                                                       th:onclick="'toggleWishlist(' + ${book.bookId} + '); return false;'" 
                                                       th:id="'wishlist-btn-' + ${book.bookId}"
                                                       class="wishlist-btn"
                                                       title="Add to Wishlist">
                                                    <i class="fa fa-heart"></i></a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- single-product-end -->
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" th:classappend="${viewType} == 'list' ? 'show active' : ''" id="list">
                        <div th:if="${books.isEmpty()}">
                            <p class="text-center">No books found.</p>
                        </div>
                        <div th:unless="${books.isEmpty()}">
                            <div class="single-shop mb-30" th:each="book : ${books.content}">
                                <div class="row">
                                    <div class="col-lg-4 col-md-4 col-12">
                                        <div class="product-wrapper-2">
                                            <div class="product-img">
                                                <a th:href="@{/shop/product/{id}(id=${book.bookId})}">
                                                    <img th:src="${book.imageUrl != null ? book.imageUrl : '/user/img/product/1.jpg'}"
                                                         th:alt="${book.title}"
                                                         class="primary"/>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-8 col-md-8 col-12">
                                        <div class="product-wrapper-content">
                                            <div class="product-details">
                                                <div class="product-rating">
                                                    <ul>
                                                        <li th:each="i : ${#numbers.sequence(1, 5)}">
                                                            <a href="#">
                                                                <i th:classappend="${i <= 4 ? 'fa fa-star' : 'fa fa-star-o'}"></i>
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <h4><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                                       th:text="${book.title}">Book Title</a></h4>
                                                <div class="product-price">
                                                    <ul>
                                                        <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                            class="old-price"
                                                            style="text-decoration: line-through; color: #888;"
                                                            th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                            $0.00
                                                        </li>
                                                        <li th:if="${book.discountPercent != null && book.discountPercent > 0}"
                                                            th:text="'$' + ${#numbers.formatDecimal(book.discountPrice, 1, 2)}"
                                                            style="color:#d4af37;font-weight:bold;">
                                                            $0.00
                                                        </li>
                                                        <li th:if="${book.discountPercent == null || book.discountPercent == 0}"
                                                            th:text="'$' + ${#numbers.formatDecimal(book.price, 1, 2)}">
                                                            $0.00
                                                        </li>
                                                    </ul>
                                                </div>
                                                <p th:text="${book.description != null ? (#strings.abbreviate(book.description, 200)) : 'No description available'}">
                                                    Description</p>
                                            </div>
                                            <div class="product-link">
                                                <div class="product-button">
                                                    <a href="#" 
                                                       th:if="${book.stock > 0}"
                                                       th:onclick="'addToCart(' + ${book.bookId} + ', 1); return false;'"
                                                       title="Add to cart">
                                                        <i class="fa fa-shopping-cart"></i>Add to cart
                                                    </a>
                                                    <a href="#" 
                                                       th:if="${book.stock == 0}"
                                                       class="disabled"
                                                       style="pointer-events: none; opacity: 0.5; cursor: not-allowed;"
                                                       title="Out of stock">
                                                        <i class="fa fa-shopping-cart"></i>Add to cart
                                                    </a>
                                                </div>
                                                <div class="add-to-link">
                                                    <ul>
                                                        <li><a th:href="@{/shop/product/{id}(id=${book.bookId})}"
                                                               title="Details">
                                                            <i class="fa fa-external-link"></i></a></li>
                                                        <li><a href="#" 
                                                               th:onclick="'toggleWishlist(' + ${book.bookId} + '); return false;'" 
                                                               th:id="'wishlist-btn-' + ${book.bookId}"
                                                               class="wishlist-btn"
                                                               title="Add to Wishlist">
                                                            <i class="fa fa-heart"></i></a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- single-shop-end -->
                    </div>
                </div>
                <!-- tab-area-end -->
                <!-- pagination-area-start -->
                <div class="pagination-area mt-50" th:if="${totalPages > 1}">
                    <div class="list-page-2">
                        <p th:text="'Items ' + ${currentPage * books.size + 1} + '-' + ${(currentPage == totalPages - 1) ? totalItems : (currentPage + 1) * books.size} + ' of ' + ${totalItems}">
                            Items 1-9 of 11
                        </p>
                    </div>
                    <div class="page-number">
                        <ul>
                            <li th:if="${currentPage > 0}">
                                <a th:href="@{/shop(view=${viewType}, page=${currentPage - 1}, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir})}"
                                   class="angle">
                                    <i class="fa fa-angle-left"></i>
                                </a>
                            </li>
                            <li th:each="pageNum : ${#numbers.sequence(0, totalPages - 1)}">
                                <a th:href="@{/shop(view=${viewType}, page=${pageNum}, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir})}"
                                   th:classappend="${pageNum == currentPage ? 'active' : ''}"
                                   th:text="${pageNum + 1}">1</a>
                            </li>
                            <li th:if="${currentPage < totalPages - 1}">
                                <a th:href="@{/shop(view=${viewType}, page=${currentPage + 1}, size=${books.size}, categoryId=${selectedCategory}, search=${searchKeyword}, sortBy=${sortBy}, sortDir=${sortDir})}"
                                   class="angle">
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- pagination-area-end -->
            </div>
        </div>
    </div>
</div>
<!-- shop-main-area-end -->
<!-- footer-area-start -->
<div th:replace="common/user/footer :: footer"></div>
<!-- footer-area-end -->
<!-- Modal -->
<div class="modal fade" id="productModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">x</span></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-5 col-sm-5 col-xs-12">
                        <div class="modal-tab">
                            <div class="product-details-large tab-content">
                                <div class="tab-pane active" id="image-1">
                                    <img src="img/product/quickview-l4.jpg" alt=""/>
                                </div>
                                <div class="tab-pane" id="image-2">
                                    <img src="img/product/quickview-l2.jpg" alt=""/>
                                </div>
                                <div class="tab-pane" id="image-3">
                                    <img src="img/product/quickview-l3.jpg" alt=""/>
                                </div>
                                <div class="tab-pane" id="image-4">
                                    <img src="img/product/quickview-l5.jpg" alt=""/>
                                </div>
                            </div>
                            <div class="product-details-small quickview-active owl-carousel">
                                <a class="active" href="#image-1"><img src="img/product/quickview-s4.jpg" alt=""/></a>
                                <a href="#image-2"><img src="img/product/quickview-s2.jpg" alt=""/></a>
                                <a href="#image-3"><img src="img/product/quickview-s3.jpg" alt=""/></a>
                                <a href="#image-4"><img src="img/product/quickview-s5.jpg" alt=""/></a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- Modal end -->


    <!-- all js here -->
    <div th:replace="common/user/js :: js"></div>
    <script>
        // Wishlist functionality
        function toggleWishlist(bookId) {
            fetch('/wishlist/toggle', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                credentials: 'same-origin', // Include cookies for session
                body: 'bookId=' + bookId
            })
            .then(response => {
                // Check if response is ok (200-299)
                if (!response.ok) {
                    // If 403 or 401, redirect to login
                    if (response.status === 403 || response.status === 401) {
                        showToast('You need to login to add items to wishlist. Redirecting to login page...', 'warning');
                        setTimeout(function() {
                            window.location.href = '/login';
                        }, 2000);
                        return null;
                    }
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (!data) return; // User was redirected
                
                if (data.redirect) {
                    window.location.href = data.redirect;
                    return;
                }
                
                if (data.success) {
                    // Update wishlist button state
                    const btn = document.getElementById('wishlist-btn-' + bookId);
                    if (btn) {
                        const icon = btn.querySelector('i');
                        if (data.inWishlist) {
                            btn.classList.add('in-wishlist');
                            if (icon) {
                                icon.classList.remove('fa-heart-o');
                                icon.classList.add('fa-heart');
                            }
                            btn.style.color = '#d4af37';
                            btn.title = 'Remove from Wishlist';
                        } else {
                            btn.classList.remove('in-wishlist');
                            if (icon) {
                                icon.classList.remove('fa-heart');
                                icon.classList.add('fa-heart-o');
                            }
                            btn.style.color = '';
                            btn.title = 'Add to Wishlist';
                        }
                    }
                    
                    // Show toast message
                    showToast(data.message, 'success');
                    
                    // Update wishlist count if element exists
                    if (data.wishlistCount !== undefined) {
                        const countElement = document.getElementById('wishlist-count');
                        if (countElement) {
                            countElement.textContent = data.wishlistCount;
                        }
                    }
                } else {
                    showToast(data.message || 'Failed to update wishlist', 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showToast('An error occurred. Please try again.', 'error');
            });
        }
        
        // Check wishlist status on page load for each book
        document.addEventListener('DOMContentLoaded', function() {
            // Get all book IDs from wishlist buttons
            const wishlistButtons = document.querySelectorAll('.wishlist-btn');
            wishlistButtons.forEach(btn => {
                const bookId = btn.id.replace('wishlist-btn-', '');
                if (bookId) {
                    // Check if book is in wishlist
                    fetch('/wishlist/check?bookId=' + bookId, {
                        credentials: 'same-origin' // Include cookies for session
                    })
                        .then(response => {
                            if (!response.ok) {
                                // If 403 or 401, user is not logged in, skip
                                return null;
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data && data.inWishlist) {
                                btn.classList.add('in-wishlist');
                                const icon = btn.querySelector('i');
                                if (icon) {
                                    icon.classList.remove('fa-heart-o');
                                    icon.classList.add('fa-heart');
                                }
                                btn.style.color = '#d4af37';
                                btn.title = 'Remove from Wishlist';
                            }
                        })
                        .catch(error => {
                            // Silently fail - user might not be logged in
                            console.log('Wishlist check skipped (user might not be logged in)');
                        });
                }
            });
        });
    </script>
    <style>
        .wishlist-btn.in-wishlist {
            color: #d4af37 !important;
        }
        .wishlist-btn:hover {
            color: #d4af37 !important;
        }
    </style>
</body>


<!-- Mirrored from htmldemo.net/koparion/koparion/shop.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Nov 2025 15:14:53 GMT -->
</html>

<div class="price">

    <span>$70.00</span>

</div>

<p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis

    egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet.</p>

<div class="quick-view-select">

    <div class="select-option-part">

        <label>Size*</label>

        <select class="select">

            <option value="">S</option>

            <option value="">M</option>

            <option value="">L</option>

        </select>

    </div>

    <div class="quickview-color-wrap">

        <label>Color*</label>

        <div class="quickview-color">

            <ul>

                <li class="blue">b</li>

                <li class="red">r</li>

                <li class="pink">p</li>

            </ul>

        </div>

    </div>

</div>

<form action="#">

    <input type="number" value="1"/>

    <button>Add to cart</button>

</form>

<span><i class="fa fa-check"></i> In stock</span>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

<!-- Modal end -->


<!-- all js here -->

<div th:replace="common/user/js :: js"></div>

</body>


<!-- Mirrored from htmldemo.net/koparion/koparion/shop.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Nov 2025 15:14:53 GMT -->

</html>

